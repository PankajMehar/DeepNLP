ii“paper-drugcomb”—2018/2/1—14:55—page1—#1iiiiiiModelingPolypharmacySideEffectswithGraphConvolutionalNetworksMarinkaZitnik1,MonicaAgrawal1andJureLeskovec1,2,∗1DepartmentofComputerScience,StanfordUniversity,Stanford,CA,USA2ChanZuckerbergBiohub,SanFrancisco,CA,USA∗Towhomcorrespondenceshouldbeaddressed.AbstractMotivation:Theuseofmultipledrugs,termedpolypharmacy,iscommontotreatpatientswithcomplexdiseasesorco-existingmedicalconditions.However,amajorconsequenceofpolypharmacyisamuchhigherriskofadversesideeffectsforthepatient.Polypharmacysideeffectsemergebecauseofdrug-druginteractions,inwhichactivityofonedrugmaychange,favorablyorunfavorably,iftakenwithanotherdrug.Theknowledgeofdruginteractionsisoftenlimitedbecausethesecomplexrelationshipsarerare,andareusuallynotobservedinrelativelysmallclinicaltesting.Discoveringpolypharmacysideeffectsthusremainsanimportantchallengewithsigniﬁcantimplicationsformortalityandmorbidityofpatients.Results:Herewetakeadvantageoftheincreasingunderstandingofnetwork-baseddrugactivitytointroduceDecagon,anapproachformodelingpolypharmacysideeffects.Theapproachconstructsamultimodalgraphofprotein-proteininteractions,drug-proteintargetinteractions,andthepolypharmacysideeffects,whicharerepresentedasdrug-druginteractions,whereeachsideeffectisanedgeofadifferenttype.Decagonisdevelopedspeciﬁcallytohandlesuchmultimodalgraphswithalargenumberofedgetypes.Ourapproachdevelopsanewgraphconvolutionalneuralnetworkformultirelationallinkpredictioninmultimodalnetworks.Unlikeapproacheslimitedtopredictingsimpledrug-druginteractionscalarvalues,Decagoncanpredicttheexactsideeffect,ifany,throughwhichagivendrugcombinationmanifestsclinically.Decagonaccuratelypredictspolypharmacysideeffects,outperformingbaselinesbyupto69%.Weﬁndthatitautomaticallylearnsrepresentationsofsideeffectsindicativeofco-occurrenceofpolypharmacyinpatients.Furthermore,Decagonmodelsparticularlywellpolypharmacysideeffectsthathaveastrongmolecularbasis,whileonpredominantlynon-molecularsideeffects,itachievesgoodperformancebecauseofeffectivesharingofmodelparametersacrossedgetypes.Decagoncreatesanopportunitytouselargemolecular,pharmacological,andpatientpopulationdatatoﬂagandprioritizepolypharmacysideeffectsforfollow-upanalysisviaformalpharmacoepidemiologicalstudies.Availability:Sourcecodeandpreprocesseddatasetsareathttp://snap.stanford.edu/decagon.Contact:jure@cs.stanford.edu1IntroductionMosthumandiseasesarecausedbycomplexbiologicalprocessesthatareredundantandresistanttothetherapeuticactivityofanysingledrug(Jiaetal.,2009;Hanetal.,2017).Apromisingstrategytoenhancetherapeuticeffectsandcombatdiseasesispolypharmacy,acombinatorialtherapyinvolvingtheconcurrentuseofmultiplemedications,alsotermedadrugcombination(Bansaletal.,2014).Adrugcombinationconsistsofmultipledrugs,eachofwhichhasgenerallybeenusedasasingleeffectivemedicationinapatientpopulation.Sincedrugsinadrugcombinationcanmodulatetheactivityofdistinctproteins,drugcombinationscanimprovetherapeuticefﬁcacybyovercomingtheredundancyinunderlyingbiologicalprocesses(Sunetal.,2015).Forexample,adrugcombinationofVenetoclaxandIdasanutlinhasrecentlybeenshowntoleadtosuperiorantileukemicefﬁcacyinthetreatmentofacutemyeloidleukemia(Panetal.,2017).Herethetwodrugsworkinreciprocalways:VenetoclaxinhibitsantiapoptoticBcl-2familyproteinswhileIdasanutlinactivatesthep53pathway,andtherefore,thecombinationofthesetwodrugsshowssigniﬁcantlyprolongedsurvivalbysimultaneouslytargetingcomplementarymechanisms(Panetal.,2017).Whiletheuseofmultipledrugsmaybeagoodpracticeforthetreatmentofmanydiseases(LieblerandGuengerich,2005;Tatonettietal.,2012),amajorconsequenceofpolypharmacytoapatientisamuchhigherriskofsideeffectswhichareduetodrug-druginteractions.Polypharmacyii“paper-drugcomb”—2018/2/1—14:55—page2—#2iiiiii2Zitniketal.sideeffectsaredifﬁculttoidentifymanuallybecausetheyarerare,itispracticallyimpossibletotestallpossiblepairsofdrugsandsideeffectsareusuallynotobservedinrelativelysmallclinicaltrials(Tatonettietal.,2012;Bansaletal.,2014).Furthermore,polypharmacyisrecognizedasanincreasinglyseriousprobleminthehealthcaresystemaffectingnearly15%oftheU.S.population(Kantoretal.,2015),andcostingmorethan$177billionayearintheU.S.intreatingpolypharmacysideeffects(ErnstandGrizzle,2001).Invitroexperimentsandclinicaltrialscanbeperformedtoidentifydrug-druginteractions(Lietal.,2015;RyallandTan,2015),butsystematiccombinatorialscreeningofdrug-druginteractioncandidatesremainschallengingandexpensive(Bansaletal.,2014).Researchershavethusattemptedtocollectdrug-druginteractionsfromscientiﬁcliteratureandelectronicmedicalrecords(Perchaetal.,2012;Vilaretal.,2017),andalsodiscoveredthemthroughnetworkmodeling,analysisofmoleculartargetsignatures(Sunetal.,2015;Huangetal.,2014b;Lewisetal.,2015;Chenetal.,2016a;Takedaetal.,2017),statisticalassociation-basedmodels,andsemi-supervisedlearning(Zhaoetal.,2011;Huangetal.,2014a;Chenetal.,2016b;Shietal.,2017)(seerelatedworkinSection7).Whiletheseapproachescanbeusefultoderivebroadrulesfordescribingdruginteractionatthecellularlevel,theycannotdirectlyguidetranslationalstrategiesfordrugcombinationtreatments.Inparticular,thesemethodsweredevelopedtocharacterizedrug-druginteractionsthroughscalarvaluesrepresentingtheoverallprobability/strengthofaninteractionbutcannotpredicttheexacttypeofthesideeffect.Moreprecisely,fordrugsiandjthesemethodspredictiftheircombinationproducesanyexaggeratedresponseSijoverandbeyondtheadditiveresponseexpectedundernointeraction,regardlessoftheexacttypeorthenumberofsideeffects.Thatis,theirgoalistoansweraquestion:Sij?6={},whereSijisthesetofallpolypharmacysideeffectsattributedspeciﬁcallytoadrugpairi,jbutnottoeitherdrugalone.However,muchmoreimportantandusefulistoanswerwhetherapairofdrugsi,jwillinteractwithagivensideeffectoftyper,r?∈Sij.Eventhoughidentiﬁcationofprecisepolypharmacysideeffectsiscriticalforimprovedpatientcare,itremainsachallengingtaskthathasnotyetbeenstudiedthroughpredictivemodeling.Presentwork.Here,wedevelopDecagon,amethodforpredictingexactsideeffectsofdrugpairs.Wemodeltheproblembyconstructingalargetwo-layermultimodalgraphofprotein-proteininteractions,drug-proteininteractions,anddrug-druginteractions(i.e.,sideeffects)(Figure1).Eachdrug-druginteractionislabeledbyadifferentedgetype,whichsigniﬁesthetypeofthesideeffect.Wethendevelopanewmultirelationallinkpredictionmodelthatusesthemultimodalgraphtopredictdrug-druginteractionsaswellastheirtypes.Ourmodelbuildsonstate-of-the-artconvolutionalgraphneuralnetworksandextendsthemtoamultirelationallinkpredictionsetting.Tomotivateourmodel,weﬁrstperformexploratoryanalysisleadingtotwoimportantobservations(Section3).First,weﬁndthatco-prescribeddrugs(i.e.,drugcombinations)tendtohavemoretargetproteinsincommonthanrandomdrugpairs,suggestingthatdrug-targetproteininformationcontainsvaluableinformationfordrugcombinationmodeling.Second,weﬁndthatitisimportanttoconsideramapofprotein-proteininteractionsinordertobeabletomodelcharacteristicsofdrugswithcommonsideeffects.TheseobservationsmotivatethedevelopmentofDecagontomakepredictionsaboutwhichpairsdrugswillinteractandwhatwilltheexacttypeoftheinteraction/sideeffect(Section4).Decagondevelopsanewgraphauto-encoderapproach(Hamiltonetal.,2017a)whichallowsustodevelopanend-to-endtrainablemodelformultirelationallinkpredictiononamultimodalgraph.Incontrast,previousgraph-basedapproachesforlinkpredictiontasksinbiology(e.g.,Huangetal.(2014b);Chenetal.(2016b);Zongetal.(2017))employatwo-stagepipeline,typicallyconsistingofagraphfeatureextractionmodelandalinkpredictionmodel,bothofwhicharetrainedseparately.Furthermore,theDrugProteinr1Gastrointestinal bleed side effect  r2Bradycardia side effectProtein-protein interactionDrug-protein interactionPolypharmacy side effectsCiprofloxacinSimvastatinDoxycyclineMupirocinr2r2r1Node feature vectorDSMCFig.1.Anexamplegraphofpolypharmacysideeffectsderivedfromgenomicandpatientpopulationdata.Amultimodalgraphconsistsofprotein-proteininteractions,drug-proteintargets,anddrug-druginteractionsencodedby964differentpolypharmacysideeffects(i.e.,edgetypesri,i=1,...,964).Sideinformationisintegratedintothemodelintheformofadditionalproteinanddrugfeaturevectors.HighlightednetworkneighborsofCiproﬂoxacin(nodeC)indicatethisdrugtargetsfourproteinsandinteractswiththreeotherdrugs.ThegraphencodesinformationthatCiproﬂoxacin(nodeC)takentogetherwithDoxycycline(nodeD)orwithSimvastatin(nodeS)increasestheriskofbradycardiasideeffect(sideeffecttyper2),anditscombinationwithMupirocin(M)increasestheriskofgastrointestinalbleedsideeffectr1.WeusethegraphrepresentationtodevelopDecagon,agraphconvolutionalneuralmodelofpolypharmacysideeffects.Decagonpredictsassociationsbetweenpairsofdrugsandsideeffects(showninred)withthegoalofidentifyingsideeffects,whichcannotbeattributedtoeitherindividualdruginthepair.crucialdistinguishingcharacteristicofDecagonisthemultirelationallinkpredictionabilityallowingustocapturetheinterdependenceofdifferentedge(sideeffect)types,andtoidentifywhichoutofallpossibleedgetypesexistbetweenanytwodrugnodesinthegraph.Thisisinsharpcontrastwithapproachesforsimplelinkprediction(Trouillonetal.,2016),whichpredictonlyexistenceofedgesbetweennodepairs,andisalsocriticalformodelingalargenumberofdifferentedge/sideeffecttypes.WecontrastDecagon’sperformancewiththatofstate-of-the-artapproachesformulti-relationaltensorfactorization(Nickeletal.,2011;Papalexakisetal.,2017),approachesforrepresentationlearningongraphs(Perozzietal.,2014;Zongetal.,2017),andestablishedmulti-stagemachinelearningapproachesforlinkprediction,whichweadaptedforthepolypharmacysideeffectpredictiontask.Decagonoutperformsalternativeapproachesbyupto69%andleadstoa20%averagegaininpredictiveperformance,withlargergainsachievedonsideeffecttypesthathaveastrongmolecularbasis(Section6).Forseveralnovelpredictionsweﬁndsupportingevidenceinthebiomedicalliterature,suggestingthatDecagonperformsespeciallywellatidentifyingpredictionsthatarehighlylikelytobetruepositive.Takentogether,thisstudyshows,fortheﬁrsttime,theabilitytomodelpolypharmacysideeffectsofdrugcombinationsandopensnewopportunitiesfortranslationalscienceanddevelopmentofnewdrugcombinationtherapies.2DatasetsWeformulatethepolypharmacysideeffectidentiﬁcationproblemasamultirelationallinkpredictionprobleminatwo-layermultimodalgraph/networkoftwonodetypes:drugsandproteins.Weconstructtwo-layermultimodalnetworkasfollows(Figure1):Protein-proteininteractionnetworkdescribesrelationshipsbetweenproteins.Drug-druginteractionnetworkcontains964differenttypesofedges(oneforeachsideeffectii“paper-drugcomb”—2018/2/1—14:55—page3—#3iiiiiiModelingPolypharmacySideEffectswithGraphConvolutionalNetworks3type)anddescribeswhichdrugpairsleadtowhichsideeffects.Lastly,drug-proteinlinksdescribetheproteinstargetedbyagivendrug.Wecontinuebydescribingthedatasetsusedtoconstructthenetwork.Preprocessedversionsofalldatasetsareavailablethroughthisstudy’swebsite:http://snap.stanford.edu/decagon.2.1Protein-proteinanddrug-proteininteractionsWeusedthehumanprotein-proteininteraction(PPI)networkcompiledbyMencheetal.(2015)andChatr-Aryamontrietal.(2015),integratedwithadditionalPPIinformationfromSzklarczyketal.(2017),andRollandetal.(2014).Thenetworkcontainsphysicalinteractionsexperimentallydocumentedinhumans,suchasmetabolicenzyme-coupledinteractionsandsignalinginteractions.Thenetworkisunweightedandundirectedwith19,085proteinsand719,402physicalinteractions.WeobtainedrelationshipsbetweenproteinsanddrugsfromtheSTITCH(SearchToolforInTeractionsofCHemicals)database,whichintegratesvariouschemicalandproteinnetworks(Szklarczyketal.,2015).Forthiswork,weconsideredonlytheinteractionsbetweensmallchemicals(i.e.,drugs)andtargetproteinsthathadbeenexperimentallyveriﬁed.Therewereover8,083,600interactionspresentbetween8,934proteinsand519,022chemicals.2.2Drug-druginteractionandsideeffectdataWealsopulledfromdatabasesdetailingsideeffectsofbothindividualdrugsanddrugcombinations.TheSIDER(SideEffectResource)databasecontains286,399drug-sideeffectassociationsover1,556drugsand5,868sideeffects(Kuhnetal.,2015)obtainedbyminingadverseeventsfromdruglabeltext.WeintegrateditwiththeOFFSIDESdatabase,whichdetailsoff-label487,530associationsbetween1,332drugsand10,097sideeffects(Tatonettietal.,2012).TheOFFSIDESdatabasewasgeneratedusingadverseeventreportingsystemsthatcollectreportsfromdoctors,patients,anddrugcompanies.Aftercombiningthesedatasets,thereisamedianof159sideeffectsperdrug,withthemostcommonsideeffectsbeingnausea,vomiting,headache,diarrhoea,anddermatitis.WepulledpolypharmacysideeffectinformationfromTWOSIDES,whichdetails1,318sideeffectstypesacross63,473drugcombinations,whicharegreaterthanexpectedgiventheeffectsofeitherdruginthecombinationindividually(Tatonettietal.,2012).LikeOFFSIDES,TWOSIDESwasgeneratedfromadverseeventreportingsystems.Commonsideeffects,likehypotensionandnausea,occurinoverathirdofdrugcombinations,whileotherslikeamnesiaandmusclespasmsonlyoccurinahandfulofdrugcombinations.Overall,itcontains4,651,131drugcombination-sideeffectassociations.Inthiswork,wefocusonpredictingthe964commonly-occurringtypesofpolypharmacysideeffectsthateachoccurredinatleast500drugcombinations.Theﬁnalnetworkafterlinkingentityvocabulariesusedbydifferentdatabaseshas645drugand19,085proteinnodesconnectedby715,612protein-protein,4,651,131drug-drug,and18,596drug-proteinedges.3Data-drivenmotivationforDecagonapproachHerewemakethreeobservationsaboutthestructureofthetwo-layermultimodalgraph(Figure1)thathaveimportantimplicationsforthedesignoftheDecagonmodel.First,weobservethatthereisawiderangeinhowfrequentlycertainsideeffectsoccurindrugcombinations.Weﬁndthatmorethan53%ofpolypharmacysideeffectsareknowntooccurinlessthan3%ofthedocumenteddrugcombinations(e.g.,cerebralarteryembolism,lungabscess,sarcoma,collagendisorder).Incontrast,themorefrequentsideeffects,(e.g.,vomiting,weightgain,nausea,anaemia),occuranorderofmagnitudemoreoften.DuetothelargevariationinthenumberofdrugTable1.Percentco-occurrenceofhypertensionandnauseawiththe50mostfrequentsideeffectsindrugcombinations,annotatedwithexamples.Thevastmajorityofsideeffectsareeithersigniﬁcantlyoverrepresentedorunderrepresentedwithrespecttohowoftentheyappearindrugcombinationswithnausea/hypertension,atα=0.05,afterBonferronicorrection.PolypharmacysideeffectSOverrepresentedco-occurrenceUnderrepresentedco-occurrenceInsigniﬁcantco-occurrenceHypertension44%(hyperglycemia,anxiety,dizziness)48%(fever,sepsis,dermatitis)8%(cough,tachycardia)Nausea54%(diarrhea,insomnia,asthenia)34%(edema,anemia,neutropenia)12%(fever,dyspnea)Fraction of drug pairsNo shared target proteins(0-50]% sharedtarget proteins(50-100]% sharedtarget proteinsCo-prescribed drug pairs(i.e., drug combinations)Fig.2.Jaccardsimilaritybetweentargetproteinsforrandompairsofdrugs,alldrugcombinations,anddrugcombinationsassociatedwithspeciﬁcsideeffects.Drugpairsarestratiﬁedintothreegroupsdependingonwhetherdrugiandjinagivenpair(i,j)donotshareanytargetproteins,sharefewerthan50%targetproteins,orsharemorethan50%targetproteins(i.e.,Jaccard(Ti,Tj)=0,0<Jaccard(Ti,Tj)<0.5,and0.5≤Jaccard(Ti,Tj)≤1,respectively;Tiisasetofi’stargetproteins).Weobservethatdrugsinmostdrugpairs,especiallyinrandomdrugpairs(i.e.,drugsnotcommonlyco-prescribed,darkgrey)havezerosharedtargetproteins.pairseachsideeffectisassociatedwith,thereareonlyalimitednumberofdrugpairsavailableforindependentlytrainingmodelsforpredictionofdifferentsideeffecttypes.Asaresult,polypharmacyside-effectpredictionbecomesachallengingtask,especiallywhenpredictingrarersideeffects,andthusitisimportanttodevelopanend-to-endapproachsuchthatthemodelisabletoshareinformationandlearnfromallsideeffectsatonce.Second,weobservethatpolypharmacysideeffectsdonotappearindependentlyofoneanotherinco-prescribeddrugpairs(i.e.,drugcombinations),suggestingthatjointmodelingovermultiplesideeffectscanaidinthepredictiontask.Toquantifytheco-occurrencebetweensideeffects,wecountthenumberofdrugcombinationsinwhichagivensideeffectco-occurswithothersideeffects,andthenusepermutationtestingwithanullmodelofrandomco-occurrence.AsexempliﬁedforhypertensionandnauseainTable1,weﬁndthatthemajorityofthemostcommonsideeffectsareeithersigniﬁcantlyoverrepresentedorunderrepresentedwithrespecttohowoftentheyco-occurwithnausea/hypertensionassideeffectsindrugcombinations,atα=0.05.Thisobservationpointstotheexistenceofmechanismsthatmaycontributetothesharedpathophysiologyofsideeffects,similartowhathasbeenobservedindiseasecomorbidity(Leeetal.,2008).Forexample,weﬁndthathypertensionsigniﬁcantlyco-occurswithanxietybutco-occurslessoftenwithfeverthandictatedbyrandomchance(Table1).Theserelationshipsholdacrossthesideeffectdataset.Weconcludethatapredictionmodelshouldleveragedependencebetweensideeffectsandbeabletore-usetheinformationlearnedaboutthemolecularbasisofonesideeffecttobetterunderstandthemolecularbasisofanothersideeffect.ii“paper-drugcomb”—2018/2/1—14:55—page4—#4iiiiii4Zitniketal.Third,weprobetherelationshipbetweenproteinstargetedbyadrugpairandoccurrenceofsideeffects.LetTirepresentasetoftargetproteinsassociatedwithdrugi,wethencalculatetheJaccardsimilaritybetweentargetproteinsofagivendrugpair(i,j).Wemakeseveralobservations:(1)Morethan68%ofdrugcombinationshavezerotargetproteinsincommon,suggestingitisimportanttouseprotein-proteininteractioninformationto“connect”differentproteinstargetedbydifferentdrugs.(2)Randomdrugpairshavesmalleroverlapintargetedproteinsthanco-prescribeddrugs(Figure2,lightgrey),p-value=5e−120,2-sampleKolmogorov-Smirnov(KS)test.(3)Weﬁndthatthistrendisunequallyobservedacrossdifferentsideeffects.Forexample,highbloodpressuremorestronglyappearsindrugcombinationswithsharedtargetproteinsthan,forexample,ribfracture(Figure2,purple).Over150sideeffectsappearincombinationsthatdiffersigniﬁcantly(atα=0.05afterBonferronicorrection)fromtheothertruedrugcombinations,pera2-sampleKStest,suggestingastrongmolecularbasisofthesesideeffects.Basedonthisﬁndings,weconcludeitisimportantforamodeltoconsiderhowproteinsinteractwitheachotherandtobeabletomodellongerchainsof(indirect)interactions.4GraphconvolutionalDecagonapproachWecastpolypharmacysideeffectmodelingasamultirelationallinkpredictionproblemonamultimodalgraphencodingdrug,protein,andsideeffectrelationships(Figure1).Moreprecisely,theserelationshipsarerepresentedbyagraphG=(V,R)withNnodes(e.g.,proteins,drugs)vi∈Vandlabelededges(relations)(vi,r,vj),whereristheedgetype(relationtype):(1)physicalbindingbetweentwoproteins,(2)atargetrelationshipbetweenadrugandaprotein,or(3)aparticulartypeofasideeffectbetweentwodrugs.AsmentionedinSection2weconsider964differentrelationtypesbetweendrugs(i.e.,sideeffects).Inaddition,weallowforinclusionofsideinformationintheformofadditionalnodefeatures.Differentnodes(drugs,proteins)canhavedifferentnumberofnodefeatures,givenbyreal-valuedfeaturevectorsx1,x2,...,xNassignedtoeverynodeinthegraph.Polypharmacysideeffectpredictiontask.Polypharmacysideeffectpredictiontaskconsiderstheproblemofidentifyingassociationsbetweendrugpairsandsideeffects.Importantly,theseassociationsarelimitedtoonlythosethatcannotbeattributedtoeitherdrugalone.UsingthegraphG,thetaskistopredictlabelededgesbetweendrugnodes.Givenadrugpair(vi,vj),ouraimistodeterminehowlikelyanedgeeij=(vi,r,vj)oftyperbelongstoR,meaningthatconcurrentuseofdrugsviandvj(i.e.,theuseofadrugcombination(vi,vj))isassociatedwithapolypharmacysideeffectoftyperinthehumanpatientpopulation.Tothisaim,wedevelopanon-linear,multi-layerconvolutionalgraphneuralnetworkmodelDecagonthatoperatesdirectlyongraphG.Decagonhastwomaincomponents:•anencoder:agraphconvolutionalnetworkoperatingonGandproducingembeddingsfornodesinG(Figure3A)(Section4.1),and•adecoder:atensorfactorizationmodelusingtheseembeddingstomodelpolypharmacysideeffects(Figure3B)(Section4.2).WeproceedbydescribingDecagon,ourapproachformodelingpolypharmacysideeffects.4.1GraphconvolutionalencoderWeﬁrstdescribethegraphencodermodel,whichtakesasinputagraphGandadditionalnodefeaturevectorsxi,andproducesanoded-dimensionalembeddingzi∈Rdforeverynode(drug,protein)inthegraph.Weproposeanencodermodelthatmakesefﬁcientuseofinformationsharingacrossregionsinthegraphandassignsseparateprocessingchannelsforeachrelationtype.TheideaisthatDecagonlearnshowtotransformandpropagateinformation,capturedbynodefeaturevectors,acrossthegraph.Everynode’snetworkneighborhooddeﬁnesadifferentneuralnetworkinformationpropagationarchitecturebutthesearchitecturesthensharefunctions/parametersthatdeﬁnehowinformationissharedandpropagated.Welearnconvolutionaloperatorsthatpropagateandtransforminformationacrossdifferentpartsofthegraphandacrossdifferentrelationtypes.Themodelinspiredbyarecentclassofconvolutionalneuralnetworksthatoperatedirectlyongraphs(Defferrardetal.,2016;KipfandWelling,2016).ForagivennodeDecagonperformstransformation/aggregationoperationsonfeaturevectorsofitsneighbors.ThiswayDecagononlytakesintoaccounttheﬁrst-orderneighborhoodofanodeandappliesthesametransformationacrossalllocationsinthegraph.SuccessiveapplicationoftheseoperationstheneffectivelyconvolvesinformationacrosstheK-thorderneighborhood(i.e.,embeddingofanodedependsonallthenodesthatareatmostKstepsaway),whereKisthenumberofsuccessiveoperationsofconvolutionallayersintheneuralnetworkmodel.Ineachlayer,Decagonpropagateslatentnodefeatureinformationacrossedgesofthegraph,whiletakingintoaccountthetype(relation)ofanedge(Schlichtkrulletal.,2017).Asinglelayerofthisneuralnetworkmodeltakesthefollowingform:h(k+1)i=φ(cid:18)XrXj∈NircijrW(k)rh(k)j+cirh(k)i(cid:19),(1)whereh(k)i∈Rd(k)isthehiddenstateofnodeviinthek-thlayeroftheneuralnetworkwithd(k)beingthedimensionalityofthislayer’srepresentation,risarelationtype,andmatrixW(k)risarelation-typespeciﬁcparametermatrix.Here,φdenotesannon-linearelement-wiseactivationfunction(i.e.,arectiﬁedlinearunit),whichtransformstherepresentationstobeusedinthelayeroftheneuralmodel,cijrandcirarenormalizationconstants,whichwechoosetobesymmetriccijr=1/p|Nir||Njr|andcir=1/|Nir|withNirdenotingthesetofneighborsofnodeviunderrelationr.ImportantlynotethatthesuminEq.1rangesonlyovertheneighborsNirofagivennodeiandthusthecomputationalarchitecture(i.e.,theneuralnetwork)isdifferentforeverynode.Figure3Ashowsanexampleofaper-layerconvolutionalupdateEq.(1)fornodeCfromFigure1.And,Figure3Cthenillustratesthatdifferentnodeshavedifferentstructuresofneuralnetworks(becauseeachnode’snetworkneighborhoodisdifferent).Adeepermodelcanbebuiltbychainingmultiple(i.e.,K)oftheselayers(Figure3A)withappropriateactivationfunctions.Toarriveattheﬁnalembeddingzi∈Rdofnodevi,wecomputeitsrepresentationas:zi=h(K)i.Theoverallencoderthentakesthefollowingform.WestackKlayersasdeﬁnedinEq.(1)suchthattheoutputofthepreviouslayerbecomestheinputtothenextlayer.Theinputtotheﬁrstlayerarenodefeaturevectors,h(0)i=xi,oruniqueone-hotvectorsforeverynodeinthegraphifnofeaturesarepresent.4.2TensorfactorizationdecoderSofar,weintroducedDecagon’sencoder.Theencodermapseachnodevi∈Vtoaanembedding,areal-valuedvectorrepresentationzi∈Rd,wheredisthedimensionalityofnoderepresentations.WeproceedbydescribingthedecodercomponentofDecagon.ThegoalofdecoderistoreconstructlabelededgesinGbyrelyingonlearnednodeembeddingsandbytreatingeachlabel(edgetype)differently.Inparticular,decoderscoresa(vi,r,vj)-triplethroughafunctiongwhosegoalistoassignascoreg(vi,r,vj)representinghowlikelyitisthatdrugsviandvjareinteractingthrougharelation/sideeffecttyper(Figure3B).UsingembeddingsfornodesiandjreturnedbyDecagon’sencoder(Section4.1)ziandzj,thedecoderpredictsacandidateedge(vi,r,vj)ii“paper-drugcomb”—2018/2/1—14:55—page5—#5iiiiiiModelingPolypharmacySideEffectswithGraphConvolutionalNetworks5r1Gastrointestinal bleed effect  r2Bradycardia effectDrug target relationA batch of networks for six drugsCCSDMACB...p(     , r1,     )p(     , r2,     )p(     , r3,     )p(     , r4,     )p(     , rn,     )Querydrug pairPredictionsr1, r2, r3, ... rn  Polypharmacy                    side effectsGCN per-layer update for a single drug node (in blue)Polypharmacy side effect prediction CCSCCCCCSSSSSFig.3.OverviewofDecagonmodelarchitecture.(A)AnDecagonencoder.Shownisaper-layerupdateforasinglegraphnode(adrugnoderepresentingCiproﬂoxacinbasedonthesmallexampleinputgraphinFigure1).HiddenstateactivationsfromneighboringnodesNcraregatheredandthentransformedforeachrelationtyperindividually(i.e.,gastrointestinalbleed,bradycardia,anddrugtargetrelation).Theresultingrepresentationisaccumulatedina(normalized)sumandpassedthroughanon-linearactivationfunction(i.e.,ReLU)toproducehiddenstateofnodevcinthe(k+1)-thlayer,h(k+1)c.Thisper-nodeupdateiscomputedinparallelwithsharedparametersacrossthewholegraph.(B)Foreveryrelation,Decagondecodertakespairsofembeddings(e.g.,hiddennoderepresentationszcandzsrepresentingCiproﬂoxacinandSimvastatin)andproducesascoreforevery(potential)edgeinthegraph.Shownisthedecoderforpoypharmacysideeffectsrelationtypes.(C)Abatchofneuralnetworksthatcomputeembeddingsofsixdrugnodesintheinputgraph.InDecagon,neuralnetworksdifferfromnodetonodebuttheyallsharethesamesetofrelation-speciﬁctrainableparameters(i.e.,theparametersoftheencoderanddecoder;seeEq.(1)andEq.(2)).Thatis,boxeswiththesameshadingpatternsshareparameters,andthinrectangularboxeswithblackandwhiteshadingpatterndenotedensely-connectedneurallayers.throughafactorizedoperation:g(vi,r,vj)=zTiDrRDrzjifviandvjaredrugszTiMrzjifviandvjarebothproteins,or,viandvjareaproteinandadrug(2)followedbytheapplicationofasigmoidfunctionσtocomputeprobabilityofedge(vi,r,vj):pijr=p((vi,r,vj)∈R)=σ(g(vi,r,vi)).(3)Next,weexplainDecagon’sdecoderbydistinguishingbetweenthefollowingtwocases:(1)Whenviandvjaredrugnodes,thedecoderginEq.(2)assumesaglobalmodelofdrug-druginteractions(i.e.,R)whosevariationandimportanceacrosspolypharmacysideeffectsaredescribedbyside-effect-speciﬁcdiagonalfactors(i.e.,Dr).Here,Risatrainableparametermatrixofshaped×dthatmodelsglobaldrug-druginteractionsacrossallpossiblepolypharmacysideeffects.Additionally,inDecagon,everyrelationrrepresentingadifferentpolypharmacysideeffectisassociatedwithadiagonald×dmatrixDrmodelingtheimportanceofeachdimensioninzitowardssideeffectr.Inanalternativeview,thisdecodercanbethoughtofasatensorfactorization(morespeciﬁcally,arank-dDEDICOMtensordecomposition(Nickeletal.,2011;Trouillonetal.,2016))ofathree-waytensor,wheretwomodesareidenticallyformedbythedrugsandthethirdmodeholdspolypharmacysideeffectsofdrugcombinations.However,adistinguishingcharacteristicofDecagonistherelianceontheencoder.Whereasclassictensordecompositionsusenoderepresentationsoptimizeddirectlyintraining,wecomputetheminanend-to-endfashionwherenodeembeddingsareoptimizedjointlytogetherwiththetensorfactorization.(2)Whenviandvjarenotbothdrugnodes,thedecoderginEq.(2)employsabilinearformtodecodeedgesfromnodeembeddings.Moreprecisely,inthatcase,thedecodingfunctiongisassociatedwithatrainableparametermatrixMrofshaped×dthatmodelsinteractionsbetweeneverytwodimensionsinziandzj.Thepredictededgeprobabilityisthencomputedusingabilinearform(Eq.(2))followedbytheapplicationofasigmoidfunction(Eq.(3)).TheuseofdifferentedgedecodersbasedonthetypeofnodesinEq.(2)iscrucialbecauseofthefollowingtworeasons:First,Decagondecodercanbeseenasaformofeffectiveparametersharingbetweendifferentrelationtypes.Inparticular,relationtypesinvolvingdrugpairsusethesameglobaldrug-druginteractionmodel(i.e.,matrixR)containingpatternsthatholdtrueacrossalldrug-relatedrelationtypes.Weexpectthatthisdecodingparameterizationcanalleviateoverﬁttingonraresideeffectsasparametersaresharedbetweenbothrare(e.g.,myringitisornasalpolyps)andfrequent(e.g.,hypotensionoranaemia)sideeffects.Second,wewantahighscoreg(vi,r,vj)toindicateanassociationbetweenadrugcombination(vi,vj)andasideeffectrthatcannotbeattributedtoviorvjalone.Tocapturethepolypharmacycombinatorics(Jiaetal.,2009),itisthusimportantthatDecagonallows,throughR,foranon-zerointeractionbetweenanytwodimensionsini’sandj’sembeddings.Takentogether,thetrainableparametersofDecagonmodelare:(1)relation-type-speciﬁcneuralnetworkweightmatricesWr,(2)relation-type-speciﬁcparametermatricesMr,(3)aglobalside-effectparametermatrixR,and(4)side-effect-speciﬁcdiagonalparametermatricesDr.Decagonencoderanddecoderthusformsanend-to-endtrainablemodelformultirelationallinkpredictioninamultimodalgraph(Figure3).NextweshalldescribehowtotraintheDecagonapproach.Inparticular,weexplainhowtotrainneuralnetworkweightsandinteractionparametermatricesusinganend-to-endlearningtechnique.4.3DecagonmodeltrainingDuringmodeltraining,weoptimizemodelparametersusingthecross-entropyloss:Jr(i,j)=−logpijr−En∼Pr(j)log(1−pinr),(4)toencouragethemodeltoassignhigherprobabilitiestoobservededges(vi,r,vj)thantorandomnon-edges.Asinpreviouswork(Mikolovetal.,2013;Trouillonetal.,2016),weestimatethemodelthroughnegativeii“paper-drugcomb”—2018/2/1—14:55—page6—#6iiiiii6Zitniketal.sampling.Foreachdrug-drugedge(vi,r,vj)(i.e.,apositiveexample)inthegraph,wesamplearandomedge(vi,r,vn)(i.e.,anegativeexample)byrandomlychoosingnodevn.Thisisachievedbyreplacingnodevjinedge(vi,r,vj)withnodevnthatisselectedrandomlyaccordingtoasamplingdistributionPr(Mikolovetal.,2013).Consideringalledges,theﬁnallossfunctioninDecagonis:J=X(vi,r,vj)∈RJr(i,j).(5)Recentresultshaveshownthatmodelinggraph-structureddatacanoftenbesigniﬁcantlyimprovedwithend-to-endlearning(Defferrardetal.,2016;Gilmeretal.,2017),thuswetakeanend-to-endoptimizationapproachandjointlyoptimizeoveralltrainableparametersandpropagatelossfunctiongradientsthroughbothDecagon’sencoderaswellasdecoder.Tooptimizethemodelwetrainitforamaximumof100epochs(trainingiterations)usingtheAdamoptimizer(KingmaandBa,2014)withalearningrateof0.001andearlystoppingwithawindowsizeof2,i.e.,westoptrainingifthevalidationlossdoesnotdecreasefortwoconsecutiveepochs.WeinitializeweightsusingtheinitializationdescribedinGlorotandBengio(2010)andaccordinglynormalizenodefeaturevectors.Inorderforthemodeltogeneralizewelltounobservededgesweapplyaregulardropout(Srivastavaetal.,2014)tohiddenlayerunits(Eq.(1)).Inpractice,weuseefﬁcientsparsematrixmultiplications,withcomplexitylinearinthenumberofedgesinG,toimplementDecagonmodel.Weusemini-batchingbysamplingcontributionstothelossfunctioninEq.(5).Thatis,weprocessmultipletrainingmini-batches,eachobtainedbysamplingonlyaﬁxednumberofcontributionsfromthesumoveredgesinEq.(5),resultingindynamicbatchesofcomputationgraphs(Figure3C).Byonlyconsideringaﬁxednumberofcontributionstothelossfunction,wecanremoverespectivedatapointsthatdonotappearinthecurrentmini-batch.Thisservesasaneffectivemeansofregularization,andreducesthememoryrequirementtotrainthemodel,whichisnecessarysothatwecanﬁtthefullmodelintoGPUmemory1.5ExperimentalsetupWeviewtheproblemofpredictingpolypharmacysideeffectsassolvingamultirelationallinkpredictiontask.Here,everydrugpairisconnectedthroughzero,one,ormorerelationtypes(i.e.,sideeffecttypes)fromasetofallrelationtypes(i.e.,allsideeffecttypes,seeSection2andFigure1).Foreachpolypharmacysideeffecttype,wesplitdrugpairsassociatedwiththatsideeffectintotraining,validation,andtestsets,ensuringthatthevalidationandtestsetseachinclude10%ofdrugpairs.Foreachsideeffecttype,weuse80%ofdrugpairstotrainamodel,and10%ofdrugpairstoselectmodelparameters.Thetaskisthentopredictpairsofdrugsthatareassociatedwitheachsideeffecttype.Notethatweareextremelycarefulthatthereisinformationleakagebetweenthefoldsandthatthecross-validationisfair.WeapplyDecagon,whichforeverydrugpairandforeverysideeffecttypecalculatesaprobabilitythatagivendrugpairisassociatedwithagivensideeffect.Additionally,weintegratesideinformation,i.e.,sideeffectsofindividualdrugs(Section2)intothemodelintheformofadditionalfeaturesfordrugnodes.Topreventanycircularityandinformationleakageintheevaluation,wemakesurethat:(1)sideeffectswearepredictingoveraretruepolypharmacysideeffects(i.e.,agivenpolypharmacysideeffectisonlyassociatedwithadrugpairandnotwithanyindividualdruginthepair),and(2)nosideeffecttypesthatwearepredictingoverareincludedinthesidefeatures.Forexample,nauseaisonepolypharmacysideeffect,andwethereforeremoveallinstancesofnauseaasasideeffectforindividualdrugs.Wenotethatthisisaconservativeapproachwhichallowsustoreliablyestimatepredictionperformance.1Alldataandcodearereleasedontheprojectwebsite.Wealsonotethatwearenotawareofanyotherapproachdevelopedspeciﬁcallyforpredictingsideeffectsofdrugpairs.WethusevaluatetheperformanceofDecagonagainstthefollowingmultirelationallinkpredictionapproaches:•RESCALtensordecomposition(Nickeletal.,2011):Thisisatensorfactorizationapproachthattakesamultirelationalstructureintoaccount.GivenXi,adrug-drugmatrixencodingassociationsofdrugspairswithsideeffectr,matrixXiisdecomposedas:Xr=ATrATforr=1,2,...,964,whereTrandAaremodelparameters.Givendrugsiandj,theirassociationwithrispredictedas:aiTraj.•DEDICOMtensordecomposition(Papalexakisetal.,2017):Thisisarelatedtensorfactorizationapproachsuitableforsparsedatasettings.Agivendrug-drugmatrixXiisdecomposedas:Xr=AUrTUrAT.Givendrugsiandj,theirassociationwithrispredictedas:aiUrTUraj.•DeepWalkneuralembeddings(Perozzietal.,2014;Zongetal.,2017):Thisapproachlearnsd-dimensionalneuralfeaturesfornodesbasedonabiasedrandomwalkprocedureexploringnetworkneighborhoodsofnodes.Drugpairsarerepresentedbyconcatenatinglearneddrugfeaturerepresentationsandusedasinputtoalogisticregressionclassiﬁer.Foreachlink-type(i.e.,sideeffecttype)wetrainaseparatelogisticregressionclassiﬁer.•Concatenateddrugfeatures:ThisapproachconstructsafeaturevectorforeachdrugbasedonPCArepresentationofdrug-targetproteininteractionmatrixandbasedonPCArepresentationofsideeffectsofindividualdrugs.Drugpairsarerepresentedbyconcatenatingthecorrespondingdrugfeaturevectorsandusedasinputtoagradientboostingtreesclassiﬁerthatthenpredictstheexactsideeffectofapairofdrugs.Theparametersettingsforeveryapproacharedeterminedusingavalidationsetwithagridsearchovercandidateparametervalues(e.g.,forgradientboostingtrees,thenumberoftreesusedwasvariedfrom10to100).Incaseanapproachisnotamultirelationallinkpredictionmethod,weselectparameterswithbestperformanceonthevalidationsetindividuallyforeachsideeffecttype.Speciﬁcally,Decagonusesa2-layerneuralarchitecturewithd(1)=64,andd(2)=32hiddenunitsineachlayer,adropoutrateof0.1,andamini-batchsizeof512inallexperiments.Performanceiscalculatedindividuallypersideeffecttypeusingareaunderthereceiver-operatingcharacteristic(AUROC),areaundertheprecision-recallcurve(AUPRC),andaverageprecisionat50(AP@50).Highervaluesalwaysindicatebetterperformance.6ResultsDecagonoperatesonmultimodalgraphsandinhighlymultirelationalsettings.ThisﬂexibilitymakesDecagonespeciallysuitableforpredictingsideeffectsofpairsofdrugsasweshalldiscussbelow.6.1PredictionofpolypharmacysideeffectsWestartbycomparingtheperformanceofDecagontoalternativeapproaches.FromresultsinTable2,weseethatconsideringthemultimodalnetworkrepresentationandmodelingalargenumberofdifferentsideeffectsallowsDecagontooutperformotherapproachesbyalargemargin.Across964sideeffecttypes,Decagonoutperformsalternativeapproachesby19.7%(AUROC),22.0%(AUPRC),and36.3%(AP@50).Decagon’simprovementisespeciallypronouncedrelativetotensorfactorizationmethods,whereDecagonsurpassestensor-basedmethodsbyupto68.7%(AP@50).Thisﬁndinghighlightsapotentiallimitationofdirectlyoptimizingatensordecomposition(i.e.,vanillaRESCALandDEDICOM(Nickeletal.,2011;Papalexakisetal.,2017))ii“paper-drugcomb”—2018/2/1—14:55—page7—#7iiiiiiModelingPolypharmacySideEffectswithGraphConvolutionalNetworks7Table2.AreaunderROCcurve(AUROC),areaunderprecision-recallcurve(AUPRC),andaverageprecisionat50(AP@50)forpolypharmacysideeffectprediction.Reportedareaverageperformancevaluesfor964sideeffecttypes.ApproachAUROCAUPRCAP@50Decagon0.8720.8320.803RESCALtensorfactorization0.6930.6130.476DEDICOMtensorfactorization0.7050.6370.567DeepWalkneuralembeddings0.7610.7370.658Concatenateddrugfeatures0.7930.7640.712Table3.SideeffectswiththebestandworstperformanceinDecagon.BestperformingsideeffectsAUPRCWorstperformingsideeffectsAUPRCMumps0.964Bleeding0.679Carbuncle0.949Increasedbodytemperature0.680Coccydynia0.943Emesis0.693Tympanicmembraneperfor.0.941Renaldisorder0.694Dyshidrosis0.938Leucopenia0.695Spondylosis0.929Diarrhea0.705Schizoaffectivedisorder0.919Icterus0.707Breastdysplasia0.918Nausea0.711Ganglion0.909Itch0.712Uterinepolyp0.908Anaemia0.712withoutrelyingonagraph-structuredconvolutionalencoder.WealsocomparedDecagonwithtwoothermethods(Perozzietal.,2014;Zongetal.,2017),whichweadaptedforamultirelationallinkpredictiontask.WeobservethatDeepWalkneuralembeddingsandConcatenateddrugfeaturesachieveagainof9.0%(AUROC)anda20.1%gain(AUPRC)overtensor-basedmethods.However,theseapproachesemployatwo-stagepipeline,consistingofadrugfeatureextractionmodelandalinkpredictionmodel,bothofwhicharetrainedseparately.Furthermore,theycannotconsiderinterdependenceofdifferentsideeffectsthatweshowedtocontainusefulinformation(Section3).Theseadditionalmodelinginsights,giveDecagona22.0%gainoverDeepWalkneuralembeddings,anda12.8%gainoverConcatenateddrugfeaturesinAP@50scores.Allinall,ourresultsarealignedwithrecentobservationsthatpredictionscanoftenbesigniﬁcantlyimprovedbyend-to-endlearningandspeciﬁcallyusinggraphauto-encoders(KipfandWelling,2016;Hamiltonetal.,2017a,b).TobetterunderstandDecagon’sperformancewestratifytheaggregatedstatisticsinTable2bysideeffecttype.Examiningthebestperformingsideeffects(Table3),weobservethatDecagonmodelsparticularlywellsideeffectsthattendtohaveastrongmolecularbasis.ThisobservationisconsistentwithourexpectationbecausethemultimodalgraphconsideredbyDecagon(Figure1)containspredominantlyinformationderivedfrommoleculardata.Wealsoobservedthatsideeffectswiththeworstperformancetendtohavenon-molecularoriginswithpotentiallyimportantenvironmentalandbehavioralcomponents(Table3).Decagon’scompetitiveperformanceonthosesideeffectscanbeexplainedbyeffectivesharingofmodelparametersacrossdifferenttypesofsideeffects.6.2InvestigationofDecagon’snovelpredictionsNext,weinvestigateDecagon’stranslationalpoweranditsabilitytogenerateactionablehypothesesaboutsideeffectsassociatedwiththeconcurrentuseoftwodrugs.Tothisaim,weaskDecagontomakeapredictionforeverydrugpairandeverysideeffecttypeinthedataset.Wethenusethesepredictionstoconstructarankedlistof(drugi,sideeffecttyper,drugj)triples,wherethetriplesarerankedbypredictedprobabilityscorespijr(Eq.(3)).Wethenexcludefromtherankedlistalltheknownassociationsbetweendrugpairsandsideeffects,andinvestigatethetenTable4.Newpolypharmacysideeffectpredictionsgivenby(drugi,sideeffecttyper,drugj)triplesthatwereassignedthehighestprobabilityscoresbyDecagon.Foreachprediction,weincludeitsrankkintherankedlistofallpredictionsandliteratureevidencesupportingexistenceofthepredictedassociation.kPolypharmacyeffectrDrugiDrugjEvidence1SarcomaPyrimethamineAliskirenStageetal.4BreastdisorderTolcaponePyrimethamineBickeretal.6RenaltubularacidosisOmeprazoleAmoxicillinRussoetal.8MuscleinﬂammationAtorvastatinAmlodipineBanakhetal.9BreastinﬂammationAliskirenTioconazoleParvingetal.highestrankedpredictionsinthelist.Wethensearchbiomedicalliteraturetoseeifwecanﬁndanysupportingevidenceforthesenovelpredictions.Table4showsDecagon’spredictionsandliteratureevidencesupportingthesepredictions.Remarkably,wewereabletoﬁndliteratureevidenceforﬁveoutoftenhighestrankedpredictedsideeffects.Thatis,ourmethodbothcorrectlyidentiﬁedthedrugpairaswellasthesideeffecttype.Randomguessingwouldhaveachanceof1:200million(200million=drugs*(drugs-1)*964/2)to“predict”therightdrugsideeffectcombination,whilewewereabletoﬁndliteraturesupportfor50%ofDecagon’spredictions.Wenotethatthecitedliteratureexplicitlyinvestigatesinteractionsbetweenthepredicteddrugpairandthepredictedsideeffect.Forexample,DecagonsigniﬁedtheuseAtorvastatinandAmlodipinecanleadtomuscleinﬂammation(Table4,8thhighestrankedprediction).Infact,recentreports(e.g.,Banakhetal.(2017))havefoundinjuriesinmuscletissueduetopresumeddruginteractionsofAtorvastatinwithAmlodipine.DecagonalsoﬂaggedapotentialassociationbetweenPyrimethamine,ananti-microbialthat,iftakenalone,iseffectiveinthetreatmentofmalaria,andAliskiren,arenininhibitor,whoseclinicaltrialwashaltedafterdiscoveredkidneycomplications(Parvingetal.,2012),suggestinganincreasedriskofcancer(1sthighestrankedprediction).TheanalysisheredemonstratesthepotentialofDecagon’spredictionstofacilitatethetranslationalscienceandthediscoveryofnovel(non)-efﬁcaciousdrugcombinations.6.3ExplorationofDecagon’ssideeffectembeddingsFinally,weareinterestedinknowingwhetherDecagonmeetsthedesigngoalspresentedinSection3.Inparticular,wetestifDecagoncancapturetheinterdependenceofdifferentsideeffecttypesrevealedbyourexploratorydataanalysis(2ndobservationinSection3).Tothisaim,wetakediagonalmatricesDr,whichspeciﬁcallymodeltheimportanceofinteractionsforeachsideeffecttyperinDecagon’smultirelationallinkprediction(Section4.2).WeextractthediagonalfromeachDranduseitasavectorrepresentationforsideeffectr.Weembedthesevectorrepresentationsintoa2Dspaceusingt-SNE(MaatenandHinton,2008)andthenvisualizeinFigure4.Figure4revealstheexistenceofclusteringstructureinsideeffects’representations.Examiningtheﬁgure,weobservethatsideeffectsembeddedclosetogetherinthe2Dspacetendtoco-occurindrugcombinations.ThisobservationindicatesthatDecagoninferssimilarmatricesDr1andDr2forsideeffectsr1andr2thatappeartogetherinmanydrugcombinations.Forexample,thetopthreesideeffectsthatoftenappeartogetherwithuterinepolypsideeffectare:uterinebleeding,breastdysplasia,andpostmenopausalbleeding.Indeed,DecagoninferssimilardiagonalfactorsDrforallthreesideeffects,resultinginlocalizedprojectionsinthe2Dspace(Figure4).TotestiftheappealingpatterninFigure4holdstrueacrossmanysideeffecttypesweproceedasfollows.WecomputeaverageEuclideandistancebetweeneachsideeffect’svectorrepresentationandvectorrepresentationsofthreemostfrequentlyco-occurringsideeffects.Weii“paper-drugcomb”—2018/2/1—14:55—page8—#8iiiiii8Zitniketal.T-SNE 1T-SNE 2ThyroiddiseaseHypothyroidCholelithiasisUterine polypPostmenopausal bleedingFibromyalgiaDiabeteshypogammaglobulinaemiaViral encephalitisBreastdysplasiaAbdominalpainSleep apneaViral meningitisPancreatitisUterine bleedingOtitis mediaFig.4.VisualizationofsideeffectsinDecagon.Thesideeffectsaremappedtothe2Dspaceusingthet-SNEpackage(MaatenandHinton,2008)withlearnedsideeffectrepresentations(Dr,r=1,2,...,964,seeEq.(2))asinput.Selectedsideeffectsareuterinepolyp,pancreatitis,viralmeningitis,andthyroiddisease.Foreachselectedsideeffect,wehighlightthreesideeffectsthatmostoftenco-occurwiththeselectedsideeffectinthedrugcombinationdataset.ﬁndthatco-occurring/relatedsideeffectshavesigniﬁcantlymoresimilarrepresentations(i.e.,diagonalfactorsDr)thanexpectedbychance(p-value=1e−34,2-sampleKStest).WethusconcludethatDecagonisabletomeetthedesigngoalsofpolypharmacysideeffectmodeling.Furthermore,theanalysishereindicatesthatDecagon’smultirelationallinkpredictionmodel(Section4.2)cancaptureinterdependenceofsideeffectspresentindrugcombinationdata.7RelatedworkWereviewrelatedresearchoncomputationalpredictionofdrugcombinations,andonneuralnetworksforgraph-structureddata.Drugcombinationmodeling.Methodsincomputationalpharmacologyaimtoﬁndassociationsbetweendrugsandmoleculartargets,predictpotentialadversedrugreactions,andﬁndnewusesofexistingdrugs(Campillosetal.,2008;Lietal.,2015;Hodosetal.,2016).Incontrasttoindividualdrugsandsingledrugtherapy(i.e.,monotherapy)predominantlyconsideredbythesemethods,weconsiderdrugcombinations(i.e.,polypharmacy).Thisisimportantaspolypharmacyisausefulstrategyforcombatingcomplexdiseases(Jiaetal.,2009;Hanetal.,2017)withimportantimplicationsforhealthcaresystem(ErnstandGrizzle,2001).Traditionally,effectivedrugcombinationshavebeenidentiﬁedbyexperimentallyscreeningallpossiblecombinationsofapre-deﬁnedsetofdrugs(Chenetal.,2016b).Giventhelargenumberofdrugs,experimentalscreensofpairwisecombinationsofdrugsposeaformidablechallengeintermsofcostandtime.Forexample,givenndrugs,therearen(n−1)/2pairwisedrugcombinationsandmanymorehigher-ordercombinations.Toaddressthecombinatorialexplosionofcandidatedrugcombinations,computationalmethodsweredevelopedtoidentifydrugpairsthatpotentiallyinteract,i.e.,drugpairsthatproduceanexaggeratedresponseoverandbeyondtheadditiveresponseexpectedundernointeraction(RyallandTan,2015).Previousresearchinthisrealmfocusedondeﬁningdrug-druginteractionsthroughtheconceptsofsynergyandantagonism(Loewe,1953;Lewisetal.,2015),quantitativelymeasuringdose-effectcurves(Bansaletal.,2014;Takedaetal.,2017),anddeterminingwhetherornotagivendrugpairinteractsaccordingtoanexperimentmeasuringcellviability(Huangetal.,2014b,a;Sunetal.,2015;ZitnikandZupan,2016;Chenetal.,2016b,a;Shietal.,2017).Alloftheseapproachespredictdrug-druginteractionsasscalarvaluesrepresentingtheoverallprobability/strengthofaninteractionforagivendrugpair.Insharpcontrast,ourworkheregoesastepfurtherandidentiﬁeshowexactly,ifatall,agivendrugpairmanifestsclinicallywithinapatientpopulation.Inparticular,wemodelclinicalmanifestationsthatcannotbeattributedtoeitherdrugaloneandthatariseduetodruginteraction(i.e.,polypharmacysideeffects).Whereaspreviousresearchfocusedongeneratingpointwiseinteractionestimatesrepresentingcellviabilityoracloselyrelatedoutcomeinanexperimentaldrugscreen,wepredict,fortheﬁrsttime,which,ifany,polypharmacysideeffectscanoccurwhenmultiplesdrugsaretakentogetherbyapatient,yieldingamoredirectpathforclinicaltranslation.Althoughpresentdrug-druginteractionpredictionapproachescannotbedirectlyusedfortheproblemstudiedhere,webrieﬂyoverviewmethodologyusedbytheseapproaches.Drug-druginteractionpredictionapproachescanbecategorizedintoclassiﬁcation-basedandsimilarity-basedmethods.Classiﬁcation-basedmethodsconsiderdrug-druginteractionpredictionasabinaryclassiﬁcationproblem(ChengandZhao,2014;Huangetal.,2014a;ZitnikandZupan,2016;Chenetal.,2016b;Shietal.,2017).Thesemethodsuseknowninteractingdrugpairsaspositiveexamplesandotherdrugpairsasnegativeexamples,andtrainclassiﬁcationmodels,suchasnaiveBayes,logisticregression,andsupportvectormachine.Incontrast,similarity-basedmethodsassumethatsimilardrugsmayhavesimilarinteractionpatterns(Gottliebetal.,2012;Vilaretal.,2012;Huangetal.,2014b;Lietal.,2015;ZitnikandZupan,2015;Sunetal.,2015;Lietal.,2017).Thesemethodsusedifferentkindsofdrug-drugsimilaritymeasuresdeﬁnedondrugchemicalsubstructures,interactionproﬁleﬁngerprints,drugsideeffects,off-sideeffects,andconnectivityofmoleculartargets.Themethodsaggregatesimilaritymeasuresthroughclusteringorlabelpropagationinordertoidentifypotentialdrug-druginteractions(Zhangetal.,2015;Ferdousietal.,2017;Zhangetal.,2017).However,allthesemethodsgeneratedrug-druginteractionscoresanddonotpredicttheexactpolypharmacysideeffect,whichisthegoalofourworkhere.Neuralnetworksongraphs.Ourmodelextendsexistingworkintheﬁeldofneuralnetworksongraphs(Hamiltonetal.,2017b;KipfandWelling,2016;Defferrardetal.,2016;Hamiltonetal.,2017a;Schlichtkrulletal.,2017;Gilmeretal.,2017).Neuralnetworksongraphsenablelearningovergraphstructuresbygeneralizingthenotionofconvolutionoperationtypicallyappliedtoimagedatasetstooperationsthatcanoperateonarbitrarygraphs.Theseneuralnetworkscanalsobeseenasanembeddingmethodologythatdistillshigh-dimensionalinformationabouteachnode’sneighborhoodintoadensevectorembeddingwithoutrequiringmanualfeatureengineering.Inparticular,graphconvolutionalnetworks(KipfandWelling,2016;Defferrardetal.,2016;Hamiltonetal.,2017a)andmessagepassingneuralnetworks(Gilmeretal.,2017)arerelatedlinesofresearchthatallowforlayer-wiselearningofnodeembeddingsingraphs.Althoughgraphconvolutionalnetworksachievestate-of-the-artperformanceonimportantpredictionproblemsinrecommendersystems,socialnetworks,andknowledgegraphs,theyhavenotyetbeenextendedtoproblemsincomputationalbiology.Ourmodelextendsgraphconvolutionalnetworksbyincorporatingsupportformultiplerelationtypes,eachtyperepresentingadifferentpolypharmacysideeffect,andbyprovidingaformofefﬁcientweightsharingformultimodalgraphswithalargenumberofrelationtypes.8ConclusionWepresentedDecagon,anapproachforpredictingsideeffectsofdrugpairs.Decagonisageneralgraphconvolutionalneuralnetworkdesignedtooperateonalargemultimodalgraphwherenodescanbeconnectedthroughalargenumberofdifferentrelationtypes.WeuseDecagonto,fortheﬁrsttime,inferapredictionmodelthatcanidentifysideeffectsofpairsofdrugs.Decagonpredictsanassociationbetweenasideeffectandaco-prescribeddrugpair(i.e.,adrugcombination)toidentifysideeffectsthatii“paper-drugcomb”—2018/2/1—14:55—page9—#9iiiiiiModelingPolypharmacySideEffectswithGraphConvolutionalNetworks9cannotbeattributedtoeitherdrugalone.Thegraphconvolutionalmodelachievesexcellentaccuracyonthepolypharmacysideeffectpredictiontask,allowsustoconsidernearlyathousanddifferentsideeffecttypesintegratingmolecularandpatientpopulationdata,andprovidesinsightsintoclinicalmanifestationofdrug-druginteractions.Thereareseveraldirectionsforfuturework.Ourapproachintegratesmolecularprotein-proteinanddrug-targetnetworkstogetherwithpopulation-levelpatients’sideeffectdata.Othersourcesofbiomedicalinformation,suchasdosedconcentrationlevelsofdrugs,mightberelevantformodelingsideeffectsofdrugpairs,andwehopetoinvestigatetheutilityofintegratingthemintothemodel.AsDecagon’sgraphconvolutionalmodelisageneralapproachformultirelationallinkpredictioninanymultimodalnetwork,itwouldbeinterestingtoapplyittootherdomainsandproblems,forexample,ﬁndingassociationsbetweenpatientoutcomesandcomorbiddiseases,orforidentifyingdependenciesbetweenmutantphenotypesandgene-geneinteractions.ReferencesBanakh,I.etal.(2017).Severerhabdomyolysisduetopresumeddruginteractionsbetweenatorvastatinwithamlodipineandticagrelor.CaseRep.inCrit.Care,2017.Bansal,M.etal.(2014).Acommunitycomputationalchallengetopredicttheactivityofpairsofcompounds.NatureBiotechnology,32(12),1213–1222.Bicker,J.etal.(2017).Elucidationoftheimpactofp-glycoproteinandbreastcancerresistanceproteinonthebraindistributionofcatechol-o-methyltransferaseinhibitors.DrugMetabolismandDisposition,45(12),1282–1291.Campillos,M.etal.(2008).Drugtargetidentiﬁcationusingside-effectsimilarity.Science,321(5886),263–266.Chatr-Aryamontri,A.etal.(2015).TheBioGRIDinteractiondatabase:2015update.NucleicAcidsRes.,43(D1),D470–D478.Chen,D.etal.(2016a).Synergyevaluationbyapathway–pathwayinteractionnetwork:anewwaytopredictdrugcombination.MolecularBioSystems,12(2),614–623.Chen,X.etal.(2016b).NLLSS:predictingsynergisticdrugcombinationsbasedonsemi-supervisedlearning.PLoSComputationalBiology,12(7),e1004975.Cheng,F.andZhao,Z.(2014).Machinelearning-basedpredictionofdrug–druginteractionsbyintegratingdrugphenotypic,therapeutic,chemical,andgenomicproperties.JAMIA,21(e2),e278–e286.Defferrard,M.,Bresson,X.,andVandergheynst,P.(2016).Convolutionalneuralnetworksongraphswithfastlocalizedspectralﬁltering.InNIPS,pages3844–3852.Ernst,F.R.andGrizzle,A.J.(2001).Drug-relatedmorbidityandmortality:updatingthecost-of-illnessmodel.JAPhA,41(2),192–199.Ferdousi,R.etal.(2017).Computationalpredictionofdrug-druginteractionsbasedondrugsfunctionalsimilarities.JournalofBiomedicalInformatics,70,54–64.Gilmer,J.etal.(2017).Neuralmessagepassingforquantumchemistry.ICML.Glorot,X.andBengio,Y.(2010).Understandingthedifﬁcultyoftrainingdeepfeedforwardneuralnetworks.InAISTATS,pages249–256.Gottlieb,A.etal.(2012).INDI:acomputationalframeworkforinferringdruginteractionsandtheirassociatedrecommendations.Mol.Syst.Biol,8(1),592.Hamilton,W.L.,Ying,R.,andLeskovec,J.(2017a).Inductiverepresentationlearningonlargegraphs.InNIPS.Hamilton,W.L.,Ying,R.,andLeskovec,J.(2017b).Representationlearningongraphs:Methodsandapplications.IEEEDataEngineeringBulletin.Han,K.etal.(2017).SynergisticdrugcombinationsforcanceridentiﬁedinaCRISPRscreenforpairwisegeneticinteractions.NatureBiotechnology.Hodos,R.A.etal.(2016).Insilicomethodsfordrugrepurposingandpharmacology.WileyInterdisciplinaryReviews:SystemsBiologyandMedicine,8(3),186–210.Huang,H.etal.(2014a).Systematicpredictionofdrugcombinationsbasedonclinicalside-effects.ScientiﬁcReports,4.Huang,L.etal.(2014b).Drugcomboranker:drugcombinationdiscoverybasedontargetnetworkanalysis.Bioinformatics,30(12),i228–i236.Jia,J.etal.(2009).Mechanismsofdrugcombinations:interactionandnetworkperspectives.NatureReviewsDrugdiscovery,8(2),111–128.Kantor,E.D.etal.(2015).TrendsinprescriptiondruguseamongadultsintheUnitedStatesfrom1999-2012.JAMA,314(17),1818–1830.Kingma,D.andBa,J.(2014).Adam:Amethodforstochasticoptimization.arXiv:1412.6980.Kipf,T.N.andWelling,M.(2016).Semi-supervisedclassiﬁcationwithgraphconvolutionalnetworks.ICLR.Kuhn,M.etal.(2015).TheSIDERdatabaseofdrugsandsideeffects.NucleicAcidsRes.,44(D1),D1075–D1079.Lee,D.-S.etal.(2008).Theimplicationsofhumanmetabolicnetworktopologyfordiseasecomorbidity.PNAS,105(29),9880–9885.Lewis,R.etal.(2015).Synergymaps:exploringcompoundcombinationsusingnetwork-basedvisualization.JournalofCheminformatics,7(1),36.Li,J.etal.(2015).Asurveyofcurrenttrendsincomputationaldrugrepositioning.BrieﬁngsinBioinformatics,17(1),2–12.Li,X.etal.(2017).Predictionofsynergisticanti-cancerdrugcombinationsbasedondrugtargetnetworkanddruginducedgeneexpressionproﬁles.ArtiﬁcialIntelligenceinMedicine.Liebler,D.C.andGuengerich,F.P.(2005).Elucidatingmechanismsofdrug-inducedtoxicity.NatureReviewsDrugDiscovery,4(5),410–420.Loewe,S.(1953).Theproblemofsynergismandantagonismofcombineddrugs.Arzneimittel-Forschung,3,285–290.Maaten,L.v.d.andHinton,G.(2008).Visualizingdatausingt-SNE.JournalofMachineLearningResearch,9,2579–2605.Menche,J.etal.(2015).Uncoveringdisease-diseaserelationshipsthroughtheincompleteinteractome.Science,347(6224),1257601.Mikolov,T.etal.(2013).Distributedrepresentationsofwordsandphrasesandtheircompositionality.InNIPS,pages3111–3119.Nickel,M.,Tresp,V.,andKriegel,H.-P.(2011).Athree-waymodelforcollectivelearningonmulti-relationaldata.InICML,volume11,pages809–816.Pan,R.etal.(2017).SyntheticlethalityofcombinedBcl-2inhibitionandp53activationinAML:Mechanismsandsuperiorantileukemicefﬁcacy.CancerCell,32(6),748–760.Papalexakis,E.E.etal.(2017).Tensorsfordatamininganddatafusion:Models,applications,andscalablealgorithms.ACMTIST,8(2),16.Parving,H.-H.etal.(2012).Cardiorenalendpointsinatrialofaliskirenfortype2diabetes.NewEnglandJournalofMedicine,367(23),2204–2213.Percha,B.etal.(2012).Discoveryandexplanationofdrug-druginteractionsviatextmining.InPaciﬁcSymposiumonBiocomputing,page410.Perozzi,B.,Al-Rfou,R.,andSkiena,S.(2014).Deepwalk:Onlinelearningofsocialrepresentations.InKDD,pages701–710.ACM.Rolland,T.etal.(2014).Aproteome-scalemapofthehumaninteractomenetwork.Cell,159(5),1212–1226.Russo,M.G.etal.(2016).Lookingfortheinteractionsbetweenomeprazoleandamoxicillininadisorderedphase.anexperimentalandtheoreticalstudy.SpectrochimicaActaPartA:Mol.andBiomol.Spectroscopy,156,70–77.Ryall,K.A.andTan,A.C.(2015).Systemsbiologyapproachesforadvancingthediscoveryofeffectivedrugcombinations.JournalofCheminformatics,7(1),7.Schlichtkrull,M.etal.(2017).Modelingrelationaldatawithgraphconvolutionalnetworks.arXiv:1703.06103.Shi,J.-Y.etal.(2017).Predictingcombinativedrugpairstowardsrealisticscreeningviaintegratingheterogeneousfeatures.BMCBioinformatics,18(12),409.Srivastava,N.etal.(2014).Dropout:asimplewaytopreventneuralnetworksfromoverﬁtting.JMLR,15(1),1929–1958.Stage,T.B.etal.(2015).Acomprehensivereviewofdrug–druginteractionswithmetformin.ClinicalPharmacokinetics,54(8),811–824.Sun,Y.etal.(2015).Combininggenomicandnetworkcharacteristicsforextendedcapabilityinpredictingsynergisticdrugsforcancer.NatureCommun,6,8481.Szklarczyk,D.etal.(2015).STITCH5:augmentingprotein–chemicalinteractionnetworkswithtissueandafﬁnitydata.NucleicAcidsRes.,44(D1),D380–D384.Szklarczyk,D.etal.(2017).TheSTRINGdatabasein2017:quality-controlledprotein–proteinassociationnetworks,madebroadlyaccessible.NucleicAcidsRes.,45(D1),D362–D368.Takeda,T.etal.(2017).Predictingdrug–druginteractionsthroughdrugstructuralsimilaritiesandinteractionnetworksincorporatingpharmacokineticsandpharmacodynamicsknowledge.JournalofCheminformatics,9(1),16.Tatonetti,N.P.etal.(2012).Data-drivenpredictionofdrugeffectsandinteractions.ScienceTranslationalMedicine,4(125),12531.Trouillon,T.etal.(2016).Complexembeddingsforsimplelinkprediction.InICML.Vilar,S.etal.(2012).Drug-druginteractionthroughmolecularstructuresimilarityanalysis.JAMIA,19(6),1066–1074.Vilar,S.,Friedman,C.,andHripcsak,G.(2017).Detectionofdrug–druginteractionsthroughdataminingstudiesusingclinicalsources,scientiﬁcliteratureandsocialmedia.BrieﬁngsinBioinformatics,pagebbx010.Zhang,P.,Wang,F.,Hu,J.,andSorrentino,R.(2015).Labelpropagationpredictionofdrug-druginteractionsbasedonclinicalsideeffects.ScientiﬁcReports,5.Zhang,W.etal.(2017).Predictingpotentialdrug-druginteractionsbyintegratingchemical,biological,phenotypicandnetworkdata.BMCBioinform.,18(1),18.Zhao,X.-M.etal.(2011).Predictionofdrugcombinationsbyintegratingmolecularandpharmacologicaldata.PLoSComputationalBiology,7(12),e1002323.Zitnik,M.andZupan,B.(2015).Datafusionbymatrixfactorization.IEEETransactionsonPatternAnalysisandMachineIntelligence,37(1),41–53.Zitnik,M.andZupan,B.(2016).Collectivepairwiseclassiﬁcationformulti-wayanalysisofdiseaseanddrugdata.InPaciﬁcSymposiumonBiocomputing,volume21,page81.Zong,N.etal.(2017).Deepminingheterogeneousnetworksofbiomedicallinkeddatatopredictnoveldrug–targetassociations.Bioinformatics,33(15),2337–2344.
